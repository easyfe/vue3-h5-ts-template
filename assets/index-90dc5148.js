import{_ as o}from"./index-7a246152.js";import{g as t}from"./common-8b140cb6.js";import{s as n}from"./index-e83d8270.js";import{v as a,r as e,ab as i,N as s,Q as c,P as l,X as r,Z as u,u as m,V as d,W as f}from"./core-314477b5.js";import{a0 as g,a1 as p,a as h,_ as I}from"./index-ac951421.js";const _=new qq.maps.Geolocation;const v=o=>(d("data-v-da43fa45"),o=o(),f(),o),P=v((()=>r("code",null,"谷歌浏览器需要使用https访问",-1))),b=v((()=>r("span",null,"当前地理位置：",-1))),L=I(a({__name:"index",setup(a){let d=e(null);const f=i(),I=()=>{f.push({name:"common-map"})},v=()=>{g({duration:0}),function(o=10){return new Promise(((a,e)=>{const i=n.getGeoLocation();if(i)return void a(i);if(!navigator.geolocation)return void e("浏览器不支持定位");const s={enableHighAccuracy:!0,timeout:1e3*o,maximumAge:3e3};navigator.geolocation.getCurrentPosition((o=>{const{latitude:e,longitude:i}=o.coords;let s={latlng:{lat:e,lng:i}};t(e,i).then((o=>{s={cityname:o.city,poiname:o.street_number,poiaddress:o.city+o.district+o.street_number,latlng:{lat:e,lng:i}},console.log("loc:",o)})).finally((()=>{n.setGeoLocation(s),a(s)}))}),(o=>{switch(o.code){case o.TIMEOUT:e("获取地理位置超时！");break;case o.POSITION_UNAVAILABLE:e("内部错误！无法获取地理位置！");break;case o.PERMISSION_DENIED:e("没有权限获取地理位置！");break;default:e(`获取地理位置异常：${o}`)}}),s)}))}().then((o=>{p(),d.value=o})).catch((o=>{h(String(o))}))},L=()=>{g({duration:0}),function(o=10){return new Promise(((t,n)=>{_.getLocation((function(o){console.log("精准定位成功",o),t(o)}),(function(){_.getIpLocation((function(o){console.log("IP定位成功",o),t(o)}),(function(o){console.error("尝试通过IP地址获取位置信息失败",o),n(o)}))}),{timeout:o,failTipFlag:!0})}))}().then((o=>{d.value=o})).finally((()=>{p()}))};return(t,n)=>{const a=o;return s(),c(a,null,{default:l((()=>[P,r("h1",{onClick:v},"点击原生定位"),r("h1",{onClick:L},"点击腾讯定位"),r("h1",{onClick:I},"点击前往腾讯地图选择"),b,r("h1",null,u(m(d)),1)])),_:1})}}}),[["__scopeId","data-v-da43fa45"]]);export{L as default};
