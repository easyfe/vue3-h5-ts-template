import{s as e,f as a,g as t,a as r,p as l}from"./utils-c5713d2f.js";import{c as n,e as o,ay as u,a9 as m,f as s,i as c,w as i}from"./index-ac951421.js";import{P as d}from"./index-e403f687.js";import{v as f,r as D,h as v,w as p,x as g,A as y}from"./core-314477b5.js";const h=(new Date).getFullYear(),[x]=n("date-picker");const V=i(f({name:x,props:o({},e,{columnsType:{type:Array,default:()=>["year","month","day"]},minDate:{type:Date,default:()=>new Date(h-10,0,1),validator:u},maxDate:{type:Date,default:()=>new Date(h+10,11,31),validator:u}}),emits:["confirm","cancel","change","update:modelValue"],setup(e,{emit:n,slots:o}){const u=D(e.modelValue),i=D(!1),f=D(),h=v((()=>i.value?e.modelValue:u.value)),x=a=>a===e.minDate.getFullYear(),V=a=>a===e.maxDate.getFullYear(),w=a=>{const{minDate:t,columnsType:r}=e,l=r.indexOf(a),n=h.value[l];if(n)return+n;switch(a){case"year":return t.getFullYear();case"month":return t.getMonth()+1;case"day":return t.getDate()}},F=()=>{const a=w("year"),l=w("month"),n=x(a)&&(a=>a===e.minDate.getMonth()+1)(l)?e.minDate.getDate():1,o=V(a)&&(a=>a===e.maxDate.getMonth()+1)(l)?e.maxDate.getDate():r(a,l);return t(n,o,"day",e.formatter,e.filter,h.value)},Y=v((()=>e.columnsType.map((a=>{switch(a){case"year":return(()=>{const a=e.minDate.getFullYear(),r=e.maxDate.getFullYear();return t(a,r,"year",e.formatter,e.filter,h.value)})();case"month":return(()=>{const a=w("year"),r=x(a)?e.minDate.getMonth()+1:1,l=V(a)?e.maxDate.getMonth()+1:12;return t(r,l,"month",e.formatter,e.filter,h.value)})();case"day":return F();default:return[]}}))));p(u,(a=>{m(a,e.modelValue)||n("update:modelValue",a)})),p((()=>e.modelValue),((e,t)=>{i.value=m(t,u.value),e=a(e,Y.value),m(e,u.value)||(u.value=e),i.value=!1}),{immediate:!0});const M=(...e)=>n("change",...e),j=(...e)=>n("cancel",...e),C=(...e)=>n("confirm",...e);return s({confirm:()=>{var e;return null==(e=f.value)?void 0:e.confirm()},getSelectedDate:()=>u.value}),()=>g(d,y({ref:f,modelValue:u.value,"onUpdate:modelValue":e=>u.value=e,columns:Y.value,onChange:M,onCancel:j,onConfirm:C},c(e,l)),o)}}));export{V as D};
