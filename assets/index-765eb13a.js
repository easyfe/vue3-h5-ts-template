var e=Math.pow;import{b as a,_ as t}from"./index-d7159458.js";import{c as l,n as o,m as r,z as n,t as i,a8 as s,K as u,X as d,D as c,I as m,E as v,M as p,j as f,w as g,a9 as h,aa as b,a7 as y,W as V,N as x,ab as S,_ as C}from"./index-e5fbf354.js";/* empty css              */import"./index-0bd550bc.js";import{F as _,a as w}from"./index-80f66ae5.js";import{u as N}from"./use-refs-9a320d2d.js";import{v as P,r as E,h as k,x as j,N as z,Q as B,P as M,u as A,b as T,X as H,_ as I,V as X,W as U}from"./core-314477b5.js";import{D as Y}from"./index-d8182935.js";import"./utils-b05fdb96.js";import"./index-943ec630.js";const[F,R]=l("rate");const W=g(P({name:F,props:{size:o,icon:r("star"),color:String,count:n(5),gutter:o,clearable:Boolean,readonly:Boolean,disabled:Boolean,voidIcon:r("star-o"),allowHalf:Boolean,voidColor:String,touchable:i,iconPrefix:String,modelValue:s(0),disabledColor:String},emits:["change","update:modelValue"],setup(a,{emit:t}){const l=u(),[o,r]=N(),n=E(),i=k((()=>a.readonly||a.disabled)),s=k((()=>i.value||!a.touchable)),g=k((()=>Array(+a.count).fill("").map(((t,l)=>function(a,t,l,o){if(a>=t)return{status:"full",value:1};if(a+.5>=t&&l&&!o)return{status:"half",value:.5};if(a+1>=t&&l&&o){const l=e(10,10);return{status:"half",value:Math.round((a-t+1)*l)/l}}return{status:"void",value:0}}(a.modelValue,l+1,a.allowHalf,a.readonly)))));let h,b,y=Number.MAX_SAFE_INTEGER,V=Number.MIN_SAFE_INTEGER;const x=()=>{b=v(n);const e=o.value.map(v);h=[],e.forEach(((e,t)=>{y=Math.min(e.top,y),V=Math.max(e.top,V),a.allowHalf?h.push({score:t+.5,left:e.left,top:e.top,height:e.height},{score:t+1,left:e.left+e.width/2,top:e.top,height:e.height}):h.push({score:t+1,left:e.left,top:e.top,height:e.height})}))},S=(e,t)=>{for(let a=h.length-1;a>0;a--)if(t>=b.top&&t<=b.bottom){if(e>h[a].left&&t>=h[a].top&&t<=h[a].top+h[a].height)return h[a].score}else{const l=t<b.top?y:V;if(e>h[a].left&&h[a].top===l)return h[a].score}return a.allowHalf?.5:1},C=e=>{i.value||e===a.modelValue||(t("update:modelValue",e),t("change",e))},_=e=>{s.value||(l.start(e),x())},w=(e,t)=>{const{icon:o,size:n,color:i,count:s,gutter:u,voidIcon:d,disabled:c,voidColor:v,allowHalf:p,iconPrefix:g,disabledColor:h}=a,b=t+1,y="full"===e.status,V="void"===e.status,_=p&&e.value>0&&e.value<1;let w;u&&b!==+s&&(w={paddingRight:f(u)});return j("div",{key:t,ref:r(t),role:"radio",style:w,class:R("item"),tabindex:c?void 0:0,"aria-setsize":s,"aria-posinset":b,"aria-checked":!V,onClick:e=>{x();let t=p?S(e.clientX,e.clientY):b;a.clearable&&l.isTap.value&&t===a.modelValue&&(t=0),C(t)}},[j(m,{size:n,name:y?o:d,class:R("icon",{disabled:c,full:y}),color:c?h:y?i:v,classPrefix:g},null),_&&j(m,{size:n,style:{width:e.value+"em"},name:V?d:o,class:R("icon",["half",{disabled:c,full:!V}]),color:c?h:V?v:i,classPrefix:g},null)])};return d((()=>a.modelValue)),c("touchmove",(e=>{if(!s.value&&(l.move(e),l.isHorizontal()&&!l.isTap.value)){const{clientX:a,clientY:t}=e.touches[0];p(e),C(S(a,t))}}),{target:n}),()=>j("div",{ref:n,role:"radiogroup",class:R({readonly:a.readonly,disabled:a.disabled}),tabindex:a.disabled?void 0:0,"aria-disabled":a.disabled,"aria-readonly":a.readonly,onTouchstartPassive:_},[g.value.map(w)])}})),[D,G]=l("slider");const K=g(P({name:D,props:{min:n(0),max:n(100),step:n(1),range:Boolean,reverse:Boolean,disabled:Boolean,readonly:Boolean,vertical:Boolean,barHeight:o,buttonSize:o,activeColor:String,inactiveColor:String,modelValue:{type:[Number,Array],default:0}},emits:["change","dragEnd","dragStart","update:modelValue"],setup(e,{emit:a,slots:t}){let l,o,r;const n=E(),i=[E(),E()],s=E(),m=u(),g=k((()=>Number(e.max)-Number(e.min))),S=k((()=>{const a=e.vertical?"width":"height";return{background:e.inactiveColor,[a]:f(e.barHeight)}})),C=a=>e.range&&Array.isArray(a),_=()=>{const{modelValue:a,min:t}=e;return C(a)?100*(a[1]-a[0])/g.value+"%":100*(a-Number(t))/g.value+"%"},w=k((()=>{const a={[e.vertical?"height":"width"]:_(),background:e.activeColor};s.value&&(a.transition="none");return a[e.vertical?e.reverse?"bottom":"top":e.reverse?"right":"left"]=(()=>{const{modelValue:a,min:t}=e;return C(a)?100*(a[0]-Number(t))/g.value+"%":"0%"})(),a})),N=a=>{const t=+e.min,l=+e.max,o=+e.step;a=x(a,t,l);const r=Math.round((a-t)/o)*o;return y(t,r)},P=()=>{const a=e.modelValue;r=C(a)?a.map(N):N(a)},z=(t,l)=>{t=C(t)?(a=>{var t,l;const o=null!=(t=a[0])?t:Number(e.min),r=null!=(l=a[1])?l:Number(e.max);return o>r?[r,o]:[o,r]})(t).map(N):N(t),h(t,e.modelValue)||a("update:modelValue",t),l&&!h(t,r)&&a("change",t)},B=a=>{if(a.stopPropagation(),e.disabled||e.readonly)return;P();const{min:t,reverse:l,vertical:o,modelValue:r}=e,i=v(n),s=o?i.height:i.width,u=Number(t)+(o?l?i.bottom-a.clientY:a.clientY-i.top:l?i.right-a.clientX:a.clientX-i.left)/s*g.value;if(C(r)){const[e,a]=r;z(u<=(e+a)/2?[u,a]:[e,u],!0)}else z(u,!0)},M=t=>{if(e.disabled||e.readonly)return;"start"===s.value&&a("dragStart",t),p(t,!0),m.move(t),s.value="dragging";const i=v(n);let u=(e.vertical?m.deltaY.value:m.deltaX.value)/(e.vertical?i.height:i.width)*g.value;if(e.reverse&&(u=-u),C(r)){const a=e.reverse?1-l:l;o[a]=r[a]+u}else o=r+u;z(o)},A=t=>{e.disabled||e.readonly||("dragging"===s.value&&(z(o,!0),a("dragEnd",t)),s.value="")},T=a=>{if("number"==typeof a){return G("button-wrapper",["left","right"][a])}return G("button-wrapper",e.reverse?"left":"right")},H=(a,r)=>{const n="dragging"===s.value;if("number"==typeof r){const e=t[0===r?"left-button":"right-button"];let i;if(n&&Array.isArray(o)&&(i=o[0]>o[1]?1^l:l),e)return e({value:a,dragging:n,dragIndex:i})}return t.button?t.button({value:a,dragging:n}):j("div",{class:G("button"),style:V(e.buttonSize)},null)},I=a=>{const t="number"==typeof a?e.modelValue[a]:e.modelValue;return j("div",{ref:i[null!=a?a:0],role:"slider",class:T(a),tabindex:e.disabled?void 0:0,"aria-valuemin":e.min,"aria-valuenow":t,"aria-valuemax":e.max,"aria-disabled":e.disabled||void 0,"aria-readonly":e.readonly||void 0,"aria-orientation":e.vertical?"vertical":"horizontal",onTouchstartPassive:t=>{"number"==typeof a&&(l=a),(a=>{e.disabled||e.readonly||(m.start(a),o=e.modelValue,P(),s.value="start")})(t)},onTouchend:A,onTouchcancel:A,onClick:b},[H(t,a)])};return z(e.modelValue),d((()=>e.modelValue)),i.forEach((e=>{c("touchmove",M,{target:e})})),()=>j("div",{ref:n,style:S.value,class:G({vertical:e.vertical,disabled:e.disabled}),onClick:B},[j("div",{class:G("bar"),style:w.value},[e.range?[I(0),I(1)]:I()])])}})),L={getPrimary:()=>getComputedStyle(document.documentElement).getPropertyValue("--van-primary-color").trim(),setCustom(e){for(const a in e)document.documentElement.style.setProperty(a,e[a])},setPrimary(e){document.documentElement.style.setProperty("--van-primary-color",e)}},Q=(e=>(X("data-v-3568cb90"),e=e(),U(),e))((()=>H("div",{class:"test"},"普通div",-1))),$={style:{margin:"16px"}},q={style:{margin:"16px"}},J=C(P({__name:"index",setup(e){const{changeLocale:l,currentLocale:o}=S(),r=E(4),n=E(50),i=k((()=>({buttonSuccessBackground:"#242424"}))),s=()=>{console.log("当前主题色：",L.getPrimary());const e=`#${Math.floor(16777215*Math.random()).toString(16)}`;L.setCustom({"--van-rate-icon-full-color":e}),L.setPrimary(e)};return(e,u)=>{const d=W,c=_,m=K,v=a,p=Y,f=w,g=t;return z(),B(g,{"theme-vars":A(i)},{default:M((()=>[j(f,null,{default:M((()=>[Q,j(c,{name:"rate",label:"评分"},{input:M((()=>[j(d,{modelValue:A(r),"onUpdate:modelValue":u[0]||(u[0]=e=>T(r)?r.value=e:null)},null,8,["modelValue"])])),_:1}),j(c,{name:"slider",label:"滑块"},{input:M((()=>[j(m,{modelValue:A(n),"onUpdate:modelValue":u[1]||(u[1]=e=>T(n)?n.value=e:null)},null,8,["modelValue"])])),_:1}),H("div",$,[j(v,{round:"",block:"",type:"primary",onClick:s},{default:M((()=>[I(" 全局切换主题 ")])),_:1})]),j(p),H("div",q,[j(v,{round:"",block:"",type:"success",onClick:u[2]||(u[2]=e=>A(l)("en-US"===A(o)?"zh-CN":"en-US"))},{default:M((()=>[I(" 切换语言 ")])),_:1})])])),_:1})])),_:1},8,["theme-vars"])}}}),[["__scopeId","data-v-3568cb90"]]);export{J as default};
