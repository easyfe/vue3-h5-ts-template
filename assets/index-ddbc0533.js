var e=Object.defineProperty,l=Object.defineProperties,a=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,n=(l,a,t)=>a in l?e(l,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[a]=t;import{c as i,e as r,R as c,t as d,m as u,n as p,I as m,U as v,w as f,P as h,_ as b}from"./index-1eed7fa5.js";import{F as j,C as x}from"./index-666a9ea2.js";/* empty css              */import{a as V}from"./common-5fc7dbb0.js";import{u as g}from"./use-refs-9a320d2d.js";import{T as w,a as N}from"./index-ff01e2e8.js";import{v as O,r as y,w as C,x as k,n as I,a9 as P,a7 as T,a as _,h as S,k as U,N as E,Q as H,P as A,A as M,u as B,b as F}from"./core-314477b5.js";import"./index-f4301285.js";import"./use-tab-status-b5f61b12.js";import"./index-279bac1b.js";const[Q,R,q]=i("cascader");const D=f(O({name:Q,props:{title:String,options:c(),closeable:d,swipeable:d,closeIcon:u("cross"),showHeader:d,modelValue:p,fieldNames:Object,placeholder:String,activeColor:String},emits:["close","change","finish","clickTab","update:modelValue"],setup(e,{slots:l,emit:a}){const t=y([]),s=y(0),[o,n]=g(),{text:i,value:c,children:d}=r({text:"text",value:"value",children:"children"},e.fieldNames),u=(e,l)=>{for(const a of e){if(a[c]===l)return[a];if(a[d]){const e=u(a[d],l);if(e)return[a,...e]}}},p=()=>{const{options:l,modelValue:a}=e;if(void 0!==a){const e=u(l,a);if(e){let a=l;return t.value=e.map((e=>{const l={options:a,selected:e},t=a.find((l=>l[c]===e[c]));return t&&(a=t[d]),l})),a&&t.value.push({options:a,selected:null}),void I((()=>{s.value=t.value.length-1}))}}t.value=[{options:l,selected:null}]},f=()=>a("close"),h=({name:e,title:l})=>a("clickTab",e,l),b=(o,r,u)=>{const{disabled:p}=o,v=!(!r||o[c]!==r[c]),f=o.color||(v?e.activeColor:void 0),h=l.option?l.option({option:o,selected:v}):k("span",null,[o[i]]);return k("li",{ref:v?n(u):void 0,role:"menuitemradio",class:[R("option",{selected:v,disabled:p}),o.className],style:{color:f},tabindex:p?void 0:v?0:-1,"aria-checked":v,"aria-disabled":p||void 0,onClick:()=>((e,l)=>{if(e.disabled)return;if(t.value[l].selected=e,t.value.length>l+1&&(t.value=t.value.slice(0,l+1)),e[d]){const a={options:e[d],selected:null};t.value[l+1]?t.value[l+1]=a:t.value.push(a),I((()=>{s.value++}))}const o=t.value.map((e=>e.selected)).filter(Boolean);a("update:modelValue",e[c]);const n={value:e[c],tabIndex:l,selectedOptions:o};a("change",n),e[d]||a("finish",n)})(o,u)},[h,v?k(m,{name:"success",class:R("selected-icon")},null):null])},j=(e,l,a)=>k("ul",{role:"menu",class:R("options")},[e.map((e=>b(e,l,a)))]),x=(a,t)=>{const{options:s,selected:o}=a,n=e.placeholder||q("select"),r=o?o[i]:n;return k(N,{title:r,titleClass:R("tab",{unselected:!o})},{default:()=>{var e,a;return[null==(e=l["options-top"])?void 0:e.call(l,{tabIndex:t}),j(s,o,t),null==(a=l["options-bottom"])?void 0:a.call(l,{tabIndex:t})]}})};return p(),C(s,(e=>{const l=o.value[e];l&&(e=>{const l=e.parentElement;l&&(l.scrollTop=e.offsetTop-(l.offsetHeight-e.offsetHeight)/2)})(l)})),C((()=>e.options),p,{deep:!0}),C((()=>e.modelValue),(e=>{if(void 0!==e){if(t.value.map((e=>{var l;return null==(l=e.selected)?void 0:l[c]})).includes(e))return}p()})),()=>k("div",{class:R()},[e.showHeader?k("div",{class:R("header")},[k("h2",{class:R("title")},[l.title?l.title():e.title]),e.closeable?k(m,{name:e.closeIcon,class:[R("close-icon"),v],onClick:f},null):null]):null,k(w,{active:s.value,"onUpdate:active":e=>s.value=e,shrink:!0,animated:!0,class:R("tabs"),color:e.activeColor,swipeable:e.swipeable,onClickTab:h},{default:()=>[t.value.map(x)]})])}})),K=O({name:"BaseArea"}),L=O(($=((e,l)=>{for(var a in l||(l={}))s.call(l,a)&&n(e,a,l[a]);if(t)for(var a of t(l))o.call(l,a)&&n(e,a,l[a]);return e})({},K),l($,a({props:P({placeholder:{default:"请选择"},fieldNames:{default:()=>({text:"text",value:"value",children:"children"})},join:{default:"/"}},{modelValue:{required:!0},modelModifiers:{}}),emits:P(["update:modelValue"],["update:modelValue"]),setup(e,{emit:l}){const a=e,t=T(e,"modelValue");let s=_([]),o=y(!1),n=y("");const i=S((()=>{if(t.value.includes(0))return n.value="","";n.value=t[t.value.length-1];const e=r(s);return t.value.reduce(((l,a)=>e[a]?l+"/"+e[a]:""),"").substr(1)})),r=e=>{const l={},t=function(e,s){l[e[a.fieldNames.value]]=e[a.fieldNames.text],e[a.fieldNames.children]&&e[a.fieldNames.children].length&&e[a.fieldNames.children].forEach((e=>{t(e)}))};return e.forEach((e=>{t(e)})),l},c=()=>{o.value=!0},d=l,u=({selectedOptions:e})=>{o.value=!1;const l=e.map((e=>{var l;return e[null==(l=a.fieldNames)?void 0:l.value]}),"");d("update:modelValue",l)};return U((()=>{V().then((e=>{s.length=0,s.push(...e)}))})),(e,l)=>{const a=j,t=D,r=h,d=x;return E(),H(d,{class:"base-area_wrapper"},{default:A((()=>[k(a,M({modelValue:B(i),"onUpdate:modelValue":l[0]||(l[0]=e=>F(i)?i.value=e:null),modelModifiers:{trim:!0},class:"base-area",placeholder:e.placeholder},e.$attrs,{readonly:"",onClick:c}),null,16,["modelValue","placeholder"]),k(r,{show:B(o),"onUpdate:show":l[3]||(l[3]=e=>F(o)?o.value=e:o=e),position:"bottom",closeable:"",round:""},{default:A((()=>[k(t,{modelValue:B(n),"onUpdate:modelValue":l[1]||(l[1]=e=>F(n)?n.value=e:n=e),class:"cascader",title:"请选择所在地区","field-names":e.fieldNames,options:B(s),closeable:!1,onCancel:l[2]||(l[2]=e=>F(o)?o.value=!1:o=!1),onFinish:u},null,8,["modelValue","field-names","options"])])),_:1},8,["show"])])),_:1})}}}))));var $;const z=b(L,[["__scopeId","data-v-db05702a"]]);export{z as default};
